# Chat with RAG System ü§ñ

–ß–∞—Ç-–±–æ—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Retrieval-Augmented Generation (RAG)** –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç–µ–º–∞—Ç–∏–∫–∞–º. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ **intfloat/multilingual-e5-small** –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ **BM25** –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–µ–º–∞—Ç–∏–∫ (15 –∫–∞—Ç–µ–≥–æ—Ä–∏–π)**
- **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã –≤ –ª—é–±–æ–º –≥–æ—Ä–æ–¥–µ –º–∏—Ä–∞**
- **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏ —Ü–µ–Ω (–≤ –≤–∏–¥–µ –≥—Ä–∞—Ñ–∏–∫–∞) –Ω–∞ —Ç–æ–ø 13 –∞–∫—Ü–∏–π –ú–æ—Å–ë–∏—Ä–∂–∏ –ø–æ –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–∏**
- **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**
- –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º intfloat/multilingual-e5-small –∏ BM25, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ç–æ—Ä—ã—Ö –±—ã–ª–∏ –ø–æ–¥–æ–±—Ä–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è (—Å–º. research)
- –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ PostgreSQL
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ Streamlit
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è —Å Docker
- –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ø–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞

## –ú–µ—Ç—Ä–∏–∫–∏ ü™Ñ
**RAGAS**:
- Faithfulness (–í–µ—Ä–Ω–æ—Å—Ç—å):  0.8072
- Answer Relevancy (–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞): 0.8961
- Context Precision (–¢–æ—á–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞): 0.5955
- Context Recall (–ü–æ–ª–Ω–æ—Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞): 0.9112

**Router**:
- Accuracy (–¢–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–º—ã): 0.95

**Embedding model**:
- Accuracy@1 (–¢–æ—á–Ω–æ—Å—Ç—å –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤–µ—Ä–Ω–æ–≥–æ —á–∞–Ω–∫–∞ –≤ —Ç–æ–ø 1 –ø–æ –±–ª–∏–∑–æ—Å—Ç–∏): 0.79
- Accuracy@5 (–¢–æ—á–Ω–æ—Å—Ç—å –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤–µ—Ä–Ω–æ–≥–æ —á–∞–Ω–∫–∞ –≤ —Ç–æ–ø 5 –ø–æ –±–ª–∏–∑–æ—Å—Ç–∏): 0.93

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ üìÅ
- chroma_db - –∫–∞—Ç–∞–ª–æ–≥ —Å –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ñ–∞–π–ª–∞–º–∏ –∏–∑ –ø–∞–ø–∫–∏ data
- data - –∫–∞—Ç–∞–ª–æ–≥ —Å —Ñ–∞–π–ª–∞–º–∏, —É—á–∞—Å—Ç–≤—É—é—â–∏–º–∏ –≤ —Ä–∞–±–æ—Ç–µ RAG
- search - –∫–∞—Ç–∞–ª–æ–≥ —Å —Ä–∞–±–æ—Ç–æ–π –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ç–æ—Ä–æ–≤ –∏ —Å–ø–æ—Å–æ–±–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ
- src - –∫–∞—Ç–∞–ª–æ–≥ —Å –∫–æ–¥–æ–º RAG

## –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:
–ù–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç –±—ã–ª–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å–∞–Ω—ã –≤ –ø–∞–ø–∫–µ **research**:
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –æ—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ (router) —á–µ—Ä–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é –ø—Ä–æ–º–ø—Ç–æ–≤.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è üõ†Ô∏è  
  
- Docker –∏ Docker Compose  
- Python 3.9+  
- API –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ LLM  
  
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ üöÄ  
  
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:  
```bash  
git clone https://github.com/e-zhenka/chat_with_rag.git cd chat_with_rag
```  
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Docker Compose:  
```bash  
docker-compose up --build
```  
  
3. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É:  
```  
http://localhost:8501  
```  
  
5. –í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ LLM –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.  
‚ùóü§è–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –Ω—É–∂–Ω–æ –Ω–µ–º–Ω–æ–≥–æ –ø–æ–¥–æ–∂–¥–∞—Ç—åüôè  
    
## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ  
  
1. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ LLM  
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ "–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞" –∏ "–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–∏—Å–∫–∞" –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏   
3. –í–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ  
4. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤–æ–ø—Ä–æ—Å–∞ –∏ –Ω–∞–π–¥–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é  
5. –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö  

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø–æ–º–∏–º–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (~500MB), –ø–æ—ç—Ç–æ–º –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ API –ø—Ä–∏–¥—ë—Ç—Å—è –ø–æ–¥–æ–∂–¥–∞—Ç—å
- –¢–∞–∫–∂–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ –Ω–∞—á–Ω—ë—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏ Whisper, –ø–æ—Å–ª–µ –µ–≥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏, –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≥–æ–ª–æ—Å–æ–≤—ã–º –≤–≤–æ–¥–æ–º!

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ üìö  
  
- –§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–µ –±—É–ª—å–¥–æ–≥–∏ (bulldog) üê∂  
- –ö–æ–º–ø–∞–Ω–∏—è Red Mad Robot (red_mad_robot) ü¶æ  
- –§–∏—Ç–Ω–µ—Å-–∫–ª—É–±—ã World Class (world_class) üèãÔ∏è‚Äç‚ôÇÔ∏è  
- Michelin (michelin) ‚≠ê  
- Telegram –±–æ—Ç—ã (telegram_bots) üì±  
- –ú–æ—Å—Ç—ã –∏ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥—ã (bridges_pipes) üåâ  
- –¢—Ä—É–¥–æ–≤–æ–π –∫–æ–¥–µ–∫—Å (labour) ‚öñÔ∏è  
- –ü–ª–∞—Ç–µ–∂–∏ –∏ –Ω–∞–ª–æ–≥–∏ (payments_taxes) üí∞  
- –í—ã—Å—à–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (education) üéì  
- –ì–æ—Å—É—Å–ª—É–≥–∏ (gosuslugi) üèõÔ∏è  
- –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∞—è –∫–æ—Ä–∑–∏–Ω–∞ (consumer_basket) üõí  
- –£—Ö–æ–¥ –∑–∞ –∫–æ–∂–µ–π –ª–∏—Ü–∞ (cosmetics) üíÑ  
- –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è Brave Bison  (brave_bison ) üõí
- –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è Rectifier Technologies  (rectifier_technologies) üöú
- –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è Starvest (starvest_plc) üìà
- –ü–æ–≥–æ–¥–∞ –≤ –∫–∞–∫–æ–º-–ª–∏–±–æ –≥–æ—Ä–æ–¥–µ ‚õÖÔ∏è
- –ê–∫—Ü–∏–∏ –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –ë–∏—Ä–∂–∏ üìà
	- LKOH
	- GAZP
	- SBER
	- TATN
	- T
	- NVTK
	- GMKN
	- ROSN
	- YDEX
	- PLZL
	- SNGS	
	- CHMF
	- NLMK
	- MOEX

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
–ü—Ä–æ—Å—Ç–æ–µ –æ–±—â–µ–Ω–∏–µ:
```
- –ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –∂–∏–∑–Ω—å?
```

–ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤, –∏—Å—Ö–æ–¥—è –∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:
```
- What was Brave bison's revenue in 2022 (in ¬£000's)?
```
–ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω –∞–∫—Ü–∏–π:
```
- –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç —Å–±–µ—Ä?
```
–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã:
```
- –ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ –≤ –ü–∏—Ç–µ—Ä–µ?
```

  
## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è üñ•Ô∏è  
  
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞  
- –í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: ChromaDB –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞  —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏ intfloat/multilingual-e5-small (–¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π —Å–º. research)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫: Bm-25 –Ω–∞ –æ—Å–Ω–æ–≤–µ rank_bm25 
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: Streamlit  
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è: Docker –∏ Docker Compose
